<!-- Cute Sticky Note - Visitor Stats -->
<div class="sticky-note-widget visitor-sticky">
  <div class="sticky-tape"></div>
  <div class="sticky-content">
    <div class="sticky-title">
      <span class="sticky-icon">üëÄ</span>
      <span>Visitors</span>
    </div>
    <div class="visitor-stats-grid">
      <div class="visitor-stat">
        <span class="stat-emoji">üåÖ</span>
        <span class="stat-label">Today</span>
        <span class="stat-value" id="today-visitors">-</span>
      </div>
      <div class="visitor-stat">
        <span class="stat-emoji">üåç</span>
        <span class="stat-label">Total</span>
        <span class="stat-value" id="total-visitors">-</span>
      </div>
    </div>
  </div>
  <div class="sticky-corner"></div>
</div>

<style>
/* Sticky Note Widget Base */
.sticky-note-widget {
  position: relative;
  margin-bottom: 20px;
  filter: drop-shadow(2px 4px 6px rgba(0, 0, 0, 0.15));
}

.sticky-note-widget.visitor-sticky .sticky-content {
  background: linear-gradient(135deg, #fff59d 0%, #fff176 100%);
}

.sticky-tape {
  position: absolute;
  top: -8px;
  left: 50%;
  transform: translateX(-50%);
  width: 60px;
  height: 20px;
  background: linear-gradient(180deg, rgba(255, 255, 255, 0.7) 0%, rgba(255, 255, 255, 0.4) 100%);
  border-radius: 2px;
  z-index: 1;
  opacity: 0.8;
}

.sticky-content {
  padding: 20px 16px 16px;
  border-radius: 2px;
  position: relative;
}

.sticky-corner {
  position: absolute;
  bottom: 0;
  right: 0;
  width: 0;
  height: 0;
  border-style: solid;
  border-width: 0 0 20px 20px;
  border-color: transparent transparent #e6db73 transparent;
}

.sticky-title {
  display: flex;
  align-items: center;
  gap: 6px;
  font-size: 14px;
  font-weight: 700;
  color: #5d4e37;
  margin-bottom: 12px;
  padding-bottom: 8px;
  border-bottom: 2px dashed rgba(93, 78, 55, 0.2);
}

.sticky-icon {
  font-size: 16px;
}

/* Visitor Stats Grid */
.visitor-stats-grid {
  display: flex;
  gap: 12px;
}

.visitor-stat {
  flex: 1;
  background: rgba(255, 255, 255, 0.5);
  border-radius: 8px;
  padding: 10px 8px;
  text-align: center;
  border: 1px dashed rgba(93, 78, 55, 0.2);
}

.visitor-stat .stat-emoji {
  display: block;
  font-size: 18px;
  margin-bottom: 4px;
}

.visitor-stat .stat-label {
  display: block;
  font-size: 10px;
  color: #7d6e57;
  text-transform: uppercase;
  letter-spacing: 0.5px;
  margin-bottom: 4px;
}

.visitor-stat .stat-value {
  display: block;
  font-size: 18px;
  font-weight: 800;
  color: #5d4e37;
  font-family: 'Georgia', serif;
}

/* Dark Theme */
html[data-theme="dark"] .sticky-note-widget.visitor-sticky .sticky-content {
  background: linear-gradient(135deg, #4a4a2a 0%, #3d3d20 100%);
}

html[data-theme="dark"] .sticky-tape {
  background: linear-gradient(180deg, rgba(100, 100, 100, 0.5) 0%, rgba(80, 80, 80, 0.3) 100%);
}

html[data-theme="dark"] .sticky-corner {
  border-color: transparent transparent #2d2d15 transparent;
}

html[data-theme="dark"] .sticky-title {
  color: #d4c896;
  border-bottom-color: rgba(212, 200, 150, 0.2);
}

html[data-theme="dark"] .visitor-stat {
  background: rgba(0, 0, 0, 0.2);
  border-color: rgba(212, 200, 150, 0.2);
}

html[data-theme="dark"] .visitor-stat .stat-label {
  color: #a89b70;
}

html[data-theme="dark"] .visitor-stat .stat-value {
  color: #e8dca0;
}

/* Mobile */
@media (max-width: 768px) {
  .sticky-note-widget {
    margin-bottom: 16px;
  }

  .sticky-content {
    padding: 16px 12px 12px;
  }

  .visitor-stat .stat-value {
    font-size: 16px;
  }
}
</style>

<script>
(function() {
  const STORAGE_KEY = 'blog_visitor_stats';
  const TODAY_KEY = 'blog_last_visit_date';

  function getTodayString() {
    const now = new Date();
    return `${now.getFullYear()}-${String(now.getMonth() + 1).padStart(2, '0')}-${String(now.getDate()).padStart(2, '0')}`;
  }

  function getStats() {
    const stored = localStorage.getItem(STORAGE_KEY);
    if (stored) {
      return JSON.parse(stored);
    }
    return { total: 0, today: 0, date: getTodayString() };
  }

  function saveStats(stats) {
    localStorage.setItem(STORAGE_KEY, JSON.stringify(stats));
  }

  function updateVisitorStats() {
    const today = getTodayString();
    const lastVisit = localStorage.getItem(TODAY_KEY);
    const stats = getStats();

    if (lastVisit !== today) {
      if (stats.date !== today) {
        stats.today = 0;
        stats.date = today;
      }

      stats.today++;
      stats.total++;

      localStorage.setItem(TODAY_KEY, today);
      saveStats(stats);
    }

    document.getElementById('today-visitors').textContent = stats.today;
    document.getElementById('total-visitors').textContent = stats.total;
  }

  if (document.readyState === 'loading') {
    document.addEventListener('DOMContentLoaded', updateVisitorStats);
  } else {
    updateVisitorStats();
  }
})();
</script>
